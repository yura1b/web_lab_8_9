#!/usr/bin/env node
const {program} = require('commander');
const pkg = require('./package.json');
const db = require('./db.js');
const api = require('./index')
program.version(pkg.version);

if (process.argv.length === 2){
  api.showAll()
  return
}

program
  .command('add <待办事项>')
  .description('添加一个待办事项')
  .action(async function (env, options) {
    const list = await db.read();
    const item = options.args.join(' ')
    list.push({title:item,done:false})
    await db.write(list)
  });

program
  .command('clear')
  .description('删除所有待办事项')
  .action(async function () {
    await db.write([])
  });

program.parse(process.argv);